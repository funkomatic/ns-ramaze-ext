<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Module: Ramaze::Helper::BananaForm</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href="../../.././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;
    
    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  
  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  
  // ]]>
  </script>

</head>
<body>



    <div id="classHeader">
        <table class="header-table">
        <tr class="top-aligned-row">
          <td><strong>Module</strong></td>
          <td class="class-name-in-header">Ramaze::Helper::BananaForm</td>
        </tr>
        <tr class="top-aligned-row">
            <td><strong>In:</strong></td>
            <td>
                <a href="../../../files/lib/ext/ramaze/helper/banana_form_rb.html">
                lib/ext/ramaze/helper/banana_form.rb
                </a>
        <br />
            </td>
        </tr>

        </table>
    </div>
  <!-- banner header -->

  <div id="bodyContent">



  <div id="contextContent">

    <div id="description">
      <h1>Banana <a href="BananaForm/Form.html">Form</a> <a href="../Helper.html">Helper</a></h1>
<h2>Overview</h2>
<p>
The banana <a href="BananaForm.html#M000029">form</a> heloer is derived
from the ramaze standard BlueForm helper.
</p>
<h2>Features:</h2>
<ul>
<li>provide additional parameters for <a
href="BananaForm.html#M000029">form</a> element css class styling

</li>
<li>provide <a href="BananaForm.html#M000029">form</a> error management that
includes an error summary and css style changing on impacted fields, very
much like the rails view helper

</li>
</ul>
<h2>Styling</h2>
<p>
All the <a href="BananaForm/Form.html">BananaForm::Form</a> methods accept
the following parameters for css styling :
</p>
<ul>
<li><b>class</b> : class for the input element

</li>
<li><b>class_label</b> : class for the input label

</li>
<li><b>class_error</b> : class for input in case of validation errors on that
field

</li>
<li><b>class_label_error</b> : class for the label if any validation errors
occur on the related input field

</li>
</ul>
<h2>Error Handling</h2>
<p>
The errors are declared in the very same way that in the BlueFrom, however
the <a href="BananaForm.html#M000029">form</a> behavior is different.
</p>
<p>
If errors have been declared, prior to <a
href="BananaForm.html#M000029">form</a> construction, the <a
href="BananaForm.html#M000029">form</a> helper class will check the
existing errors and corelate them with input fields.
</p>
<p>
The labels and fields linked to the errors will have their class attribute
changed in order to apply some highlighting or any other presentation layer
that would provide the user with hints.
</p>
<p>
Further, the <a href="BananaForm.html#M000029">form</a> will have a div
section that will display an error summary very similar to the one provided
by rails view helper.
</p>
<p>
All styles, including the summary related can be overridden by providing
the appropriate parameters in the <a
href="BananaForm/Form.html">Ramaze::Helper::BananaForm::Form</a> methods.
</p>
<p>
Please note that the gem and helper don&#8216;t provide any of the css
styles and that we consider that this is part of your job.
</p>
<h3>Declaring Errors</h3>
<p>
The errors are declared <b>before</b> the <a
href="BananaForm.html#M000029">form</a> is constructed using the following
module methods :
</p>
<ul>
<li><a href="BananaForm.html#M000030">Ramaze::Helper::BananaForm.form_error</a>
: adds a new error with name and message

</li>
<li><a
href="BananaForm.html#M000032">Ramaze::Helper::BananaForm.form_errors_from_model</a>
: adds all the errors contained in a &#8216;model&#8217; class instance
(i.e providing errors hash)

</li>
</ul>
<p>
Please note that those are the same methods than in <b>BlueForm</b>, and
that the source code is unchanged.
</p>
<h3>Error Summary Default Properties</h3>
<p>
The summary will be inserted as a div element <b>before</b> the fieldset
tag.
</p>
<p>
Default <b>id</b> and <b>class</b> are set to the <b>form_error_summary</b>
value. If you want to see something fancy in a minimum laps of type just
copy the rails <b>errorExplanation</b> style to <b>form_error_summary</b>
and include it in your <a href="BananaForm.html#M000029">form</a> page.
</p>
<h3>Default Field and Labels styles</h3>
<p>
The <a href="BananaForm.html#M000029">form</a> construction is managed by
the <a href="BananaForm/Form.html">Ramaze::Helper::BananaForm::Form</a>
class, so please check the documentation of the class methods in order to
find out the default styles.
</p>
<h2>Examples</h2>
<p>
There are a bunch of examples in the specs located under the test directory
of the gem. It is probably your best way into <a
href="BananaForm.html">BananaForm</a> &#8230;
</p>

    </div>


   </div>

    <div id="method-list">
      <h3 class="section-bar">Methods</h3>

      <div class="name-list">
      <a href="#M000029">form</a>&nbsp;&nbsp;
      <a href="#M000030">form_error</a>&nbsp;&nbsp;
      <a href="#M000031">form_errors</a>&nbsp;&nbsp;
      <a href="#M000032">form_errors_from_model</a>&nbsp;&nbsp;
      </div>
    </div>

  </div>


    <!-- if includes -->

    <div id="section">

    <div id="class-list">
      <h3 class="section-bar">Classes and Modules</h3>

      Class <a href="BananaForm/Form.html" class="link">Ramaze::Helper::BananaForm::Form</a><br />

    </div>




      


    <!-- if method_list -->
    <div id="methods">
      <h3 class="section-bar">Public Instance methods</h3>

      <div id="method-M000029" class="method-detail">
        <a name="M000029"></a>

        <div class="method-heading">
          <a href="#M000029" class="method-signature">
          <span class="method-name">form</span><span class="method-args">(options = {}, &amp;block)</span>
          </a>
        </div>
      
        <div class="method-description">
          <h2>Constructs a new <a href="BananaForm.html#M000029">form</a></h2>
<p>
Constructs a <a href="BananaForm.html#M000029">form</a> with options and an
optional block that will provide content
</p>
<h3>Example :</h3>
<p>
<a href="BananaForm.html#M000029">form</a>(:method =&gt; :post, :action
=&gt; :create, :name =&gt; &#8216;user&#8217; ) do |f|
</p>
<pre>
 f.legend('User Details')
 f.input_text 'Username', :username, @user.username
 f.input_submit 'Create New User'
</pre>
<p>
end
</p>
<h3>Note :</h3>
<p>
In a templating engine, you need to do this with an assignement statement.
For instance with Erubis it would look like this :
</p>
<p>
&lt;%=
</p>
<pre>
 form(:method =&gt; :post, :action =&gt; :create, :name =&gt; 'user' ) do |f|
   ...
 end
</pre>
<p>
%&gt;
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000029-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000029-source">
<pre>
     <span class="ruby-comment cmt"># File lib/ext/ramaze/helper/banana_form.rb, line 105</span>
105:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">form</span>(<span class="ruby-identifier">options</span> = {}, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
106:         <span class="ruby-identifier">form</span> = <span class="ruby-constant">Form</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">options</span>)
107:         <span class="ruby-identifier">form</span>.<span class="ruby-identifier">build</span>(<span class="ruby-identifier">form_errors</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
108:         <span class="ruby-identifier">form</span>
109:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000030" class="method-detail">
        <a name="M000030"></a>

        <div class="method-heading">
          <a href="#M000030" class="method-signature">
          <span class="method-name">form_error</span><span class="method-args">(name, message)</span>
          </a>
        </div>
      
        <div class="method-description">
          <h2>Adds an error to be managed by the <a href="BananaForm.html#M000029">form</a> helper</h2>
<p>
Uses flash[:<a href="BananaForm.html#M000031">form_errors</a>] placeholder
is flash is available, creates an empty hash if not.
</p>
<p>
Errors are stored as key/values of the hash.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000030-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000030-source">
<pre>
     <span class="ruby-comment cmt"># File lib/ext/ramaze/helper/banana_form.rb, line 118</span>
118:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">form_error</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">message</span>)
119:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">:flash</span>)
120:           <span class="ruby-identifier">old</span> = <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">:form_errors</span>] <span class="ruby-operator">||</span> {}
121:           <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">:form_errors</span>] = <span class="ruby-identifier">old</span>.<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">name</span>.<span class="ruby-identifier">to_s</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">message</span>.<span class="ruby-identifier">to_s</span>)
122:         <span class="ruby-keyword kw">else</span>
123:           <span class="ruby-identifier">form_errors</span>[<span class="ruby-identifier">name</span>.<span class="ruby-identifier">to_s</span>] = <span class="ruby-identifier">message</span>.<span class="ruby-identifier">to_s</span>
124:         <span class="ruby-keyword kw">end</span>
125:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000031" class="method-detail">
        <a name="M000031"></a>

        <div class="method-heading">
          <a href="#M000031" class="method-signature">
          <span class="method-name">form_errors</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <h2>Returns the error hash</h2>
<p>
Code inherited from Ramaze::Helper::BlueForm seems to return the used error
hash.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000031-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000031-source">
<pre>
     <span class="ruby-comment cmt"># File lib/ext/ramaze/helper/banana_form.rb, line 131</span>
131:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">form_errors</span>
132:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">:flash</span>)
133:           <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">:form_errors</span>] <span class="ruby-operator">||=</span> {}
134:         <span class="ruby-keyword kw">else</span>
135:           <span class="ruby-ivar">@form_errors</span> <span class="ruby-operator">||=</span> {}
136:         <span class="ruby-keyword kw">end</span>
137:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000032" class="method-detail">
        <a name="M000032"></a>

        <div class="method-heading">
          <a href="#M000032" class="method-signature">
          <span class="method-name">form_errors_from_model</span><span class="method-args">(obj)</span>
          </a>
        </div>
      
        <div class="method-description">
          <h2>Adds errors contained in a model instance</h2>
<p>
The method assumes that the object reference you&#8216;re passing as
argument responds to a method named <b>errors</b> that return a Hash of
errors
</p>
<p>
It iterates over errors and call the <a
href="BananaForm.html#M000030">form_error</a> method to insert each error
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000032-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000032-source">
<pre>
     <span class="ruby-comment cmt"># File lib/ext/ramaze/helper/banana_form.rb, line 146</span>
146:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">form_errors_from_model</span>(<span class="ruby-identifier">obj</span>)
147:         <span class="ruby-identifier">obj</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">key</span>, <span class="ruby-identifier">value</span><span class="ruby-operator">|</span>
148:           <span class="ruby-identifier">form_error</span>(<span class="ruby-identifier">key</span>.<span class="ruby-identifier">to_s</span>, <span class="ruby-identifier">value</span>.<span class="ruby-identifier">first</span> <span class="ruby-operator">%</span> <span class="ruby-identifier">key</span>)
149:         <span class="ruby-keyword kw">end</span>
150:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>


    </div>


  </div>


<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>